--- a/net/minecraft/world/entity/item/FallingBlockEntity.java
+++ b/net/minecraft/world/entity/item/FallingBlockEntity.java
@@ -19,7 +_,6 @@
 import net.minecraft.network.syncher.SynchedEntityData;
 import net.minecraft.server.level.ServerLevel;
 import net.minecraft.tags.BlockTags;
-import net.minecraft.tags.FluidTags;
 import net.minecraft.util.Mth;
 import net.minecraft.world.damagesource.DamageSource;
 import net.minecraft.world.entity.Entity;
@@ -44,6 +_,7 @@
 import net.minecraft.world.phys.BlockHitResult;
 import net.minecraft.world.phys.HitResult;
 import net.minecraft.world.phys.Vec3;
+import org.bukkit.craftbukkit.v1_20_R1.event.CraftEventFactory;
 import org.slf4j.Logger;
 
 public class FallingBlockEntity extends Entity {
@@ -53,8 +_,8 @@
    public boolean f_31943_ = true;
    private boolean f_31947_;
    public boolean f_31939_;
-   private int f_31940_ = 40;
-   private float f_149641_;
+   public int f_31940_ = 40;
+   public float f_149641_;
    @Nullable
    public CompoundTag f_31944_;
    protected static final EntityDataAccessor<BlockPos> f_31945_ = SynchedEntityData.m_135353_(FallingBlockEntity.class, EntityDataSerializers.f_135038_);
@@ -76,9 +_,16 @@
    }
 
    public static FallingBlockEntity m_201971_(Level p_201972_, BlockPos p_201973_, BlockState p_201974_) {
+      // CraftBukkit start
+      return fall(p_201972_, p_201973_, p_201974_, org.bukkit.event.entity.CreatureSpawnEvent.SpawnReason.DEFAULT);
+   }
+
+   public static FallingBlockEntity fall(Level p_201972_, BlockPos p_201973_, BlockState p_201974_, org.bukkit.event.entity.CreatureSpawnEvent.SpawnReason spawnReason) {
+      // CraftBukkit end
       FallingBlockEntity fallingblockentity = new FallingBlockEntity(p_201972_, (double)p_201973_.m_123341_() + 0.5D, (double)p_201973_.m_123342_(), (double)p_201973_.m_123343_() + 0.5D, p_201974_.m_61138_(BlockStateProperties.f_61362_) ? p_201974_.m_61124_(BlockStateProperties.f_61362_, Boolean.valueOf(false)) : p_201974_);
+      if (CraftEventFactory.callEntityChangeBlockEvent(fallingblockentity, p_201973_, p_201974_.m_60819_().m_76188_()).isCancelled()) return fallingblockentity; // CraftBukkit
       p_201972_.m_7731_(p_201973_, p_201974_.m_60819_().m_76188_(), 3);
-      p_201972_.m_7967_(fallingblockentity);
+      p_201972_.addFreshEntity(fallingblockentity, spawnReason); // CraftBukkit
       return fallingblockentity;
    }
 
@@ -117,49 +_,56 @@
          }
 
          this.m_6478_(MoverType.SELF, this.m_20184_());
-         if (!this.m_9236_().f_46443_) {
+         if (!this.f_19853_.f_46443_) {
             BlockPos blockpos = this.m_20183_();
             boolean flag = this.f_31946_.m_60734_() instanceof ConcretePowderBlock;
-            boolean flag1 = flag && this.m_9236_().m_6425_(blockpos).m_205070_(FluidTags.f_13131_);
+            boolean flag1 = flag && this.f_31946_.canBeHydrated(this.f_19853_, blockpos, this.f_19853_.m_6425_(blockpos), blockpos);
             double d0 = this.m_20184_().m_82556_();
             if (flag && d0 > 1.0D) {
-               BlockHitResult blockhitresult = this.m_9236_().m_45547_(new ClipContext(new Vec3(this.f_19854_, this.f_19855_, this.f_19856_), this.m_20182_(), ClipContext.Block.COLLIDER, ClipContext.Fluid.SOURCE_ONLY, this));
-               if (blockhitresult.m_6662_() != HitResult.Type.MISS && this.m_9236_().m_6425_(blockhitresult.m_82425_()).m_205070_(FluidTags.f_13131_)) {
+               BlockHitResult blockhitresult = this.f_19853_.m_45547_(new ClipContext(new Vec3(this.f_19854_, this.f_19855_, this.f_19856_), this.m_20182_(), ClipContext.Block.COLLIDER, ClipContext.Fluid.SOURCE_ONLY, this));
+               if (blockhitresult.m_6662_() != HitResult.Type.MISS && this.f_31946_.canBeHydrated(this.f_19853_, blockpos, this.f_19853_.m_6425_(blockhitresult.m_82425_()), blockhitresult.m_82425_())) {
                   blockpos = blockhitresult.m_82425_();
                   flag1 = true;
                }
             }
 
-            if (!this.m_20096_() && !flag1) {
-               if (!this.m_9236_().f_46443_ && (this.f_31942_ > 100 && (blockpos.m_123342_() <= this.m_9236_().m_141937_() || blockpos.m_123342_() > this.m_9236_().m_151558_()) || this.f_31942_ > 600)) {
-                  if (this.f_31943_ && this.m_9236_().m_46469_().m_46207_(GameRules.f_46137_)) {
+            if (!this.f_19861_ && !flag1) {
+               if (!this.f_19853_.f_46443_ && (this.f_31942_ > 100 && (blockpos.m_123342_() <= this.f_19853_.m_141937_() || blockpos.m_123342_() > this.f_19853_.m_151558_()) || this.f_31942_ > 600)) {
+                  if (this.f_31943_ && this.f_19853_.m_46469_().m_46207_(GameRules.f_46137_)) {
                      this.m_19998_(block);
                   }
 
                   this.m_146870_();
                }
             } else {
-               BlockState blockstate = this.m_9236_().m_8055_(blockpos);
+               BlockState blockstate = this.f_19853_.m_8055_(blockpos);
                this.m_20256_(this.m_20184_().m_82542_(0.7D, -0.5D, 0.7D));
                if (!blockstate.m_60713_(Blocks.f_50110_)) {
                   if (!this.f_31947_) {
-                     boolean flag2 = blockstate.m_60629_(new DirectionalPlaceContext(this.m_9236_(), blockpos, Direction.DOWN, ItemStack.f_41583_, Direction.UP));
-                     boolean flag3 = FallingBlock.m_53241_(this.m_9236_().m_8055_(blockpos.m_7495_())) && (!flag || !flag1);
-                     boolean flag4 = this.f_31946_.m_60710_(this.m_9236_(), blockpos) && !flag3;
+                     boolean flag2 = blockstate.m_60629_(new DirectionalPlaceContext(this.f_19853_, blockpos, Direction.DOWN, ItemStack.f_41583_, Direction.UP));
+                     boolean flag3 = FallingBlock.m_53241_(this.f_19853_.m_8055_(blockpos.m_7495_())) && (!flag || !flag1);
+                     boolean flag4 = this.f_31946_.m_60710_(this.f_19853_, blockpos) && !flag3;
                      if (flag2 && flag4) {
-                        if (this.f_31946_.m_61138_(BlockStateProperties.f_61362_) && this.m_9236_().m_6425_(blockpos).m_76152_() == Fluids.f_76193_) {
+                        if (this.f_31946_.m_61138_(BlockStateProperties.f_61362_) && this.f_19853_.m_6425_(blockpos).m_76152_() == Fluids.f_76193_) {
                            this.f_31946_ = this.f_31946_.m_61124_(BlockStateProperties.f_61362_, Boolean.valueOf(true));
                         }
 
-                        if (this.m_9236_().m_7731_(blockpos, this.f_31946_, 3)) {
-                           ((ServerLevel)this.m_9236_()).m_7726_().f_8325_.m_140201_(this, new ClientboundBlockUpdatePacket(blockpos, this.m_9236_().m_8055_(blockpos)));
+                        // CraftBukkit start
+                        if (CraftEventFactory.callEntityChangeBlockEvent(this, blockpos, this.f_31946_).isCancelled()) {
+                           this.m_146870_(); // SPIGOT-6586 called before the event in previous versions
+                           return;
+                        }
+                        // CraftBukkit end
+
+                        if (this.f_19853_.m_7731_(blockpos, this.f_31946_, 3)) {
+                           ((ServerLevel)this.f_19853_).m_7726_().f_8325_.m_140201_(this, new ClientboundBlockUpdatePacket(blockpos, this.f_19853_.m_8055_(blockpos)));
                            this.m_146870_();
                            if (block instanceof Fallable) {
-                              ((Fallable)block).m_48792_(this.m_9236_(), blockpos, this.f_31946_, blockstate, this);
+                              ((Fallable)block).m_48792_(this.f_19853_, blockpos, this.f_31946_, blockstate, this);
                            }
 
                            if (this.f_31944_ != null && this.f_31946_.m_155947_()) {
-                              BlockEntity blockentity = this.m_9236_().m_7702_(blockpos);
+                              BlockEntity blockentity = this.f_19853_.m_7702_(blockpos);
                               if (blockentity != null) {
                                  CompoundTag compoundtag = blockentity.m_187482_();
 
@@ -176,14 +_,14 @@
                                  blockentity.m_6596_();
                               }
                            }
-                        } else if (this.f_31943_ && this.m_9236_().m_46469_().m_46207_(GameRules.f_46137_)) {
+                        } else if (this.f_31943_ && this.f_19853_.m_46469_().m_46207_(GameRules.f_46137_)) {
                            this.m_146870_();
                            this.m_149650_(block, blockpos);
                            this.m_19998_(block);
                         }
                      } else {
                         this.m_146870_();
-                        if (this.f_31943_ && this.m_9236_().m_46469_().m_46207_(GameRules.f_46137_)) {
+                        if (this.f_31943_ && this.f_19853_.m_46469_().m_46207_(GameRules.f_46137_)) {
                            this.m_149650_(block, blockpos);
                            this.m_19998_(block);
                         }
@@ -202,7 +_,7 @@
 
    public void m_149650_(Block p_149651_, BlockPos p_149652_) {
       if (p_149651_ instanceof Fallable) {
-         ((Fallable)p_149651_).m_142525_(this.m_9236_(), p_149652_, this);
+         ((Fallable)p_149651_).m_142525_(this.f_19853_, p_149652_, this);
       }
 
    }
@@ -216,19 +_,20 @@
             return false;
          } else {
             Predicate<Entity> predicate = EntitySelector.f_20406_.and(EntitySelector.f_20403_);
-            Block $$8 = this.f_31946_.m_60734_();
-            DamageSource damagesource1;
-            if ($$8 instanceof Fallable) {
-               Fallable fallable = (Fallable)$$8;
-               damagesource1 = fallable.m_252932_(this);
+            DamageSource damagesource;
+            if (this.f_31946_.m_60734_() instanceof Fallable) {
+               Fallable fallable = (Fallable)this.f_31946_.m_60734_();
+               damagesource = fallable.m_252932_(this);
             } else {
-               damagesource1 = this.m_269291_().m_269564_(this);
+               predicate = EntitySelector.f_20408_;
+               damagesource = this.m_269291_().m_269564_(this);
             }
 
-            DamageSource damagesource = damagesource1;
             float f = (float)Math.min(Mth.m_14143_((float)i * this.f_149641_), this.f_31940_);
-            this.m_9236_().m_6249_(this, this.m_20191_(), predicate).forEach((p_149649_) -> {
+            this.f_19853_.m_6249_(this, this.m_20191_(), predicate).forEach((p_149649_) -> {
+               CraftEventFactory.entityDamage = this; // CraftBukkit
                p_149649_.m_6469_(damagesource, f);
+               CraftEventFactory.entityDamage = null; // CraftBukkit
             });
             boolean flag = this.f_31946_.m_204336_(BlockTags.f_13033_);
             if (flag && f > 0.0F && this.f_19796_.m_188501_() < 0.05F + (float)i * 0.05F) {
@@ -256,11 +_,10 @@
          p_31973_.m_128365_("TileEntityData", this.f_31944_);
       }
 
-      p_31973_.m_128379_("CancelDrop", this.f_31947_);
    }
 
    protected void m_7378_(CompoundTag p_31964_) {
-      this.f_31946_ = NbtUtils.m_247651_(this.m_9236_().m_246945_(Registries.f_256747_), p_31964_.m_128469_("BlockState"));
+      this.f_31946_ = NbtUtils.m_247651_(this.f_19853_.m_246945_(Registries.f_256747_), p_31964_.m_128469_("BlockState"));
       this.f_31942_ = p_31964_.m_128451_("Time");
       if (p_31964_.m_128425_("HurtEntities", 99)) {
          this.f_31939_ = p_31964_.m_128471_("HurtEntities");
@@ -278,7 +_,6 @@
          this.f_31944_ = p_31964_.m_128469_("TileEntityData");
       }
 
-      this.f_31947_ = p_31964_.m_128471_("CancelDrop");
       if (this.f_31946_.m_60795_()) {
          this.f_31946_ = Blocks.f_49992_.m_49966_();
       }
